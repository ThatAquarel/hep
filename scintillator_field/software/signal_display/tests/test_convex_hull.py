from scintillator_display.math.convex_hull import ConvexHullDetection


def test_instantiate():
    detector = ConvexHullDetection()
    assert detector


def test_bounding():
    detector = ConvexHullDetection()

    a = [
        [(1, 0), (1, 0), (1, 0), (1, 0), (1, 0), (1, 0)],
        [(1, 0), (1, 0), (1, 0), (1, 0), (1, 0), (1, 0)],
    ]
    ah_test = [
        (0, 105.0, 151.0),
        (0, 120, 151.0),
        (15.0, 105.0, 151.0),
        (15.0, 120, 151.0),
        (0, 105.0, -151.0),
        (0, 120, -151.0),
        (15.0, 105.0, -151.0),
        (15.0, 120, -151.0),
    ]
    af_test = [
        ((0, 105.0, 151.0), (15.0, 120, -151.0)),
        ((0, 120, 151.0), (15.0, 105.0, -151.0)),
        ((15.0, 105.0, 151.0), (0, 120, -151.0)),
        ((15.0, 120, 151.0), (0, 105.0, -151.0)),
    ]
    
    ah, af = detector.scintillators_to_bounds(a)
    assert ah_test == ah
    assert af_test == af

    b = [
        [(0, 1), (0, 1), (0, 1), (0, 1), (0, 1), (0, 1)],
        [(0, 1), (0, 1), (0, 1), (0, 1), (0, 1), (0, 1)],
    ]
    bh_test = [
        (105.0, 0, 151.0),
        (105.0, 15.0, 151.0),
        (120, 0, 151.0),
        (120, 15.0, 151.0),
        (105.0, 0, -151.0),
        (105.0, 15.0, -151.0),
        (120, 0, -151.0),
        (120, 15.0, -151.0),
    ]
    bf_test = [
        ((105.0, 0, 151.0), (120, 15.0, -151.0)),
        ((105.0, 15.0, 151.0), (120, 0, -151.0)),
        ((120, 0, 151.0), (105.0, 15.0, -151.0)),
        ((120, 15.0, 151.0), (105.0, 0, -151.0))
    ]

    bh, bf = detector.scintillators_to_bounds(b)
    assert bh_test == bh
    assert bf_test == bf

